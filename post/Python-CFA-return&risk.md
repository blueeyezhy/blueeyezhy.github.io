# Pythonå®è·µCFAç³»åˆ—ï¼ˆä¸€ï¼‰-- æ”¶ç›Šç‡å’Œé£é™©

è™½ç„¶æˆ‘å‰ä¸€ç¯‡æ¦‚è¦ä¸Šè¯´ï¼šè¿™ç¯‡è¦ç”¨pythonç›´è§‚çš„å±•ç¤ºï¼Œ2ä¸ªèµ„äº§çš„ç»„åˆä¸­ï¼Œèµ„äº§çš„ç›¸å…³æ€§ï¼ˆÏï¼‰ä¸é£é™©ï¼ˆÏƒï¼‰å’Œæ”¶ç›Šï¼ˆrï¼‰å…³ç³»ï¼›ä½†æ˜¯æˆ‘è§‰å¾—æœ‰å¿…è¦ä¼˜å…ˆè¯´æ˜ä¸€ä¸‹ï¼Œé‡‘èå­¦çš„æ ¸å¿ƒ-- **æ”¶ç›Šç‡å’Œé£é™©**ã€‚

**é‡‘èå­¦**ç ”ç©¶çš„æ ¸å¿ƒé—®é¢˜å°±æ˜¯åœ¨æ—¶é—´ç»´åº¦ä¸‹ï¼Œæ”¶ç›Šç‡å’Œé£é™©çš„å…³ç³»ã€‚ç›®æ ‡æ˜¯åˆé€‚çš„é£é™©æ°´å¹³ä¸‹ï¼Œè·å¾—æœ€å¤§çš„æ”¶ç›Šã€‚è€Œåº¦é‡æ”¶ç›Šç‡å’Œé£é™©çš„æŒ‡æ ‡ï¼šæ˜¯ç»Ÿè®¡æ„ä¹‰ä¸Šçš„æ”¶ç›Šç‡å‡å€¼ $r$ï¼ˆreturnï¼‰ å’Œæ”¶ç›Šç‡çš„æ ‡å‡†å·® $\sigma$ï¼ˆé£é™©æˆ–è€…æ³¢åŠ¨ç‡ï¼‰ã€‚

æ”¶ç›Šç‡æ˜¯ä»å†å²äº¤æ˜“çš„æ•°æ®ä¸­è®¡ç®—å‡ºæ¥çš„ï¼Œå½“äº¤æ˜“æ—¥çš„æ”¶ç›Šç‡ $R_{t}=(P_{t}-P_{t-1})/P_{t-1}$ ï¼ˆå…¶ä¸­$P_{t}$ æ˜¯äº¤æ˜“æ—¥ $t$ çš„æ”¶ç›˜ä»·ï¼‰ï¼›å®åŠ¡ä¸­ï¼Œä¹Ÿä¼šç”¨ $R_{t}'=ln(P_{t}/P_{t-1})$ è®¡ç®—æ”¶ç›Šç‡ï¼ˆå› ä¸ºåœ¨å®é™…æƒ…å†µä¸‹ï¼Œä»·æ ¼çš„æ³¢åŠ¨ç‡é€šå¸¸å¾ˆå°ï¼Œè¿™æ—¶$R_{t}'\approx R_{t}$ä¸”æ›²çº¿æ›´åŠ å¹³æ»‘ï¼‰ã€‚è€Œæ”¶ç›Šç‡å‡å€¼ $r$ å’Œ æ³¢åŠ¨ç‡ï¼ˆé£é™©ï¼‰$\sigma$ åˆ™æ˜¯ä¸€æ®µæ—¶é—´ä¸Š $R_{t}$ çš„å‡å€¼å’Œæ ‡å‡†å·®ã€‚

## æˆ‘ä»¬ç”¨Pythonæ¥å®è·µè®¡ç®— $r$ å’Œ $\sigma$ï¼Œå¹¶å¯¹æ¯”ä¸€ä¸‹ $R_{t}'$ å’Œ $R_{t}$
```python
import numpy as np
import matplotlib.pyplot as plt 
%matplotlib inline

date = np.linspace(0, 31, 30)           # è®¾å®šXè½´åæ ‡ç‚¹ï¼Œ0~30ï¼Œå…±30ä¸ªåæ ‡ç‚¹

price = np.random.randint(80,120,31)    # ç”Ÿæˆéšæœºä»·æ ¼ï¼Œ31ä¸ªï¼›ä»·æ ¼æ³¢åŠ¨20%
R = []                                  # æ”¶ç›Šç‡åˆ—è¡¨ï¼Œ(Pt-Pt-1)/(Pt-1)
R_ln = []                               # æ”¶ç›Šç‡åˆ—è¡¨lnï¼Œln(Pt/Pt-1)

for i in list(range(1, len(price))):    # å¾ªç¯ç”Ÿæˆæ”¶ç›Šç‡æ•°æ®ï¼Œå…±30ä¸ª
    R.append((price[i]-price[i-1])/price[i-1])
    R_ln.append(np.log(price[i]/price[i-1]))

# è®¡ç®—Rçš„å‡å€¼å’Œæ ‡å‡†å·®ï¼Œå–4ä½å°æ•°
r = np.mean(R).round(4)
Ïƒ = np.std(R).round(4)

# è®¡ç®—R_lnçš„å‡å€¼å’Œæ ‡å‡†å·®ï¼Œå–4ä½å°æ•°
r_ln = np.mean(R_ln).round(4)
Ïƒ_ln = np.std(R_ln).round(4)
    
# ç”»å¸ƒåŸºæœ¬è®¾ç½®
plt.figure(figsize=(12,5))            # è®¾å®šç”»å¸ƒå¤§å°
plt.title('$r\ &\ \sigma$')           # è®¾å®šæ ‡é¢˜ï¼ŒLaTeXè¯­æ³•
plt.xlabel('$date$',fontsize = 16)    # Xè½´æ ‡é¢˜
plt.ylabel('$r$',fontsize = 16)       # Yè½´æ ‡é¢˜
plt.ylim(-.8,.8)                      # Yè½´å–å€¼åŒºé—´

# ç”»æ›²çº¿
plt.plot((date.min()-1,date.max()+1),(r,r), color='blue', lw=2)                # rå‡å€¼çº¿
plt.plot((date.min()-1,date.max()+1),(r_ln,r_ln), color='red', lw=2)           # r_lnå‡å€¼çº¿
plt.plot(date, R, label = r'$(P_{t}-P_{t-1})/P_{t-1}$', color='blue', lw=2)    # rå˜åŠ¨æ›²çº¿
plt.plot(date, R_ln, label = r'$ln(P_{t}/P_{t-1})$', color='red', lw=2)        # r_lnå˜åŠ¨æ›²çº¿
plt.text(0.5, .5, r'$r = $'+str(r) + r'$\qquad\sigma = $'+ str(Ïƒ) , fontsize=12, color="blue")
plt.text(0.5, -.6, r'$r\_ln = $'+str(r_ln) + r'$\qquad\sigma\_ln = $'+ str(Ïƒ_ln) , fontsize=12, color="red")

# æ˜¾ç¤ºå›¾ä¾‹å’Œç”»å¸ƒ
plt.legend()
plt.savefig('rr.png')
plt.show()
```
![img](https://src.seaky.club/img/rr.png)

è¿™å‰¯å›¾æ˜¯ä¸Šé¢ä»£ç æ®µç”Ÿæˆçš„ï¼Œä»·æ ¼æ³¢åŠ¨åœ¨20%çš„æƒ…å†µä¸‹ï¼Œæ”¶ç›Šç‡ r å’Œé£é™© ğœ åœ¨ä¸åŒç®—æ³•ä¸Šçš„å¯¹æ¯”æƒ…å†µï¼›r å’Œ r_ln å­˜åœ¨æ˜¾è‘—çš„èƒŒç¦»ã€‚

æˆ‘ä»¬å†çœ‹ä¸€ä¸‹åœ¨ä¸åŒä»·æ ¼æ³¢åŠ¨æƒ…å†µä¸‹ï¼Œr å’Œ r_ln åŠ ğœ å’Œ ğœ_ln çš„å¯¹æ¯”æƒ…å†µã€‚  
è¿™æ¬¡æˆ‘ä»¬ç”¨ matplotlib å­ç”»å¸ƒæ¨ªå‘å¯¹æ¯”çš„æ–¹å¼æ¥å±•ç¤ºã€‚

```python
import numpy as np
import matplotlib.pyplot as plt 
%matplotlib inline

fig, ax = plt.subplots(1,3,figsize=(12, 4)) # åˆå§‹åŒ–ä¸€è¡Œä¸‰åˆ—ä¸‰ä¸ªç”»å¸ƒ 

date = np.linspace(0, 31, 30)       # è®¾å®šXè½´åæ ‡ç‚¹ï¼Œ0~30ï¼Œå…±30ä¸ªåæ ‡ç‚¹
price_v = [0.05, 0.15, 0.3]          # è®¾å®šä»·æ ¼æ³¢åŠ¨ç‡å¯¹æ¯”åŒºé—´price_volatility

for p_v in range(3):
    p = np.random.randint(100*(1 - price_v[p_v]),100*(1 + price_v[p_v]),31)   
    R = []                              
    R_ln = []                           

    for i in list(range(1, len(p))):    
        R.append((p[i]-p[i-1])/p[i-1])
        R_ln.append(np.log(p[i]/p[i-1]))

    r = np.mean(R).round(4)
    Ïƒ = np.std(R).round(4)

    r_ln = np.mean(R_ln).round(4)
    Ïƒ_ln = np.std(R_ln).round(4)

    ax[p_v].set_title('$Price\ volatility\ =\ $' + str(price_v[p_v]))        
    ax[p_v].set_xlabel('$date$',fontsize = 16)
    if p_v == 0 :
        ax[p_v].set_ylabel('$r$',fontsize = 16)
    ax[p_v].set_ylim(-.8, .8)                     

    ax[p_v].plot((date.min()-1,date.max()+1),(r,r), color='blue', lw=2)
    ax[p_v].plot((date.min()-1,date.max()+1),(r_ln,r_ln), color='red', lw=2)
    ax[p_v].plot(date, R, label = r'$(P_{t}-P_{t-1})/P_{t-1}$', color='blue', lw=2)
    ax[p_v].plot(date, R_ln, label = r'$ln(P_{t}/P_{t-1})$', color='red', lw=2)
    ax[p_v].text(0.5, -.5, r'$r = $'+str(r) + r'$\qquad\sigma = $'+ str(Ïƒ) , fontsize=10, color="blue")
    ax[p_v].text(0.5, -.7, r'$r\_ln = $'+str(r_ln) + r'$\qquad\sigma\_ln = $'+ str(Ïƒ_ln) , fontsize=10, color="red")

    ax[p_v].legend()

plt.savefig('rr2.png')
plt.show() 
```
![img](https://src.seaky.club/img/rr3.png)

ä»å›¾ä¸Šæˆ‘ä»¬å¯ä»¥ç›´è§‚çœ‹å‡ºï¼Œéšç€ä»·æ ¼æ³¢åŠ¨ç‡ price_volatility çš„ä¸Šå‡ï¼Œæ”¶ç›Šç‡ r çš„åœ¨ä¸¤ç§ç®—æ³•ä¸‹çš„å·®åˆ«è¶Šæ¥è¶Šå¤§ã€‚  
æ‰€ä»¥ï¼šåœ¨å€ºåˆ¸ï¼Œè‚¡ç¥¨ç­‰ä»·æ ¼æ³¢åŠ¨ç‡è¾ƒå°çš„æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ $R_{t}=ln(P_{t}/P_{t-1})$ æ¥è¿‘ä¼¼è®¡ç®—æ”¶ç›Šç‡ï¼›è€Œåœ¨è™šæ‹Ÿè´§å¸å¸‚åœºä¸Šï¼Œç”±äºä»·æ ¼æ³¢åŠ¨ç‡å¾ˆå¤§ï¼Œå¿…é¡»ä½¿ç”¨ $R_{t}=(P_{t}-P_{t-1})/P_{t-1}$ æ¥è®¡ç®—æ”¶ç›Šç‡ã€‚

**é€šè¿‡è¿™ç¯‡å†…å®¹ï¼Œæˆ‘ä»¬è¦äº†è§£é‡‘èå­¦çš„æ ¸å¿ƒæ˜¯æ”¶ç›Šç‡å’Œé£é™©ï¼›å¹¶ç”¨Pythonå®è·µäº†å®åŠ¡ä¸­è®¡ç®—æ”¶ç›Šç‡ä¸åŒæ–¹æ³•ï¼Œä»¥åŠæ˜ç¡®äº†å®ƒä»¬çš„ä½¿ç”¨æ¡ä»¶ã€‚**

## æ‰€æ„Ÿ
è¯´å®è¯å†™è¿™ç¯‡å†…å®¹çš„è¿‡ç¨‹ï¼Œè®©æˆ‘æ·±åˆ»çš„ä½“ä¼šåˆ° â€œä»¥ä¸ºè‡ªå·±ä¼šäº†ï¼Œéƒ½è®°ä½äº†â€ å’Œ â€œè‡ªå·±çœŸæ­£ä¼šäº†ï¼Œèƒ½å¤Ÿåº”ç”¨äº†â€ ä¹‹é—´çš„å·®è·æœ‰å¤šå¤§ã€‚
æ•´ç¯‡ä¸‹æ¥ï¼Œæ— è®ºå¯¹äºCFAï¼Œè¿˜æ˜¯å¯¹Pythonçš„ç†è§£éƒ½è¿›äº†ä¸€æ­¥ã€‚




---   
**å®šæŠ•è·µè¡Œç¤¾åŒº**é‡Œé¢æœ‰æä¿Šè€å¸ˆçš„**Pythonç¼–ç¨‹è¯¾**ï¼Œåˆ˜æ™“è‰³è€å¸ˆçš„**è‹±æ–‡è¯¾**(æ­£åœ¨è®²çš„æ˜¯ã€Š**beyond feelings**ã€‹)ï¼Œå»–æ™ºå°å§å§çš„å¹¸ç¦åŠ›(**æ±¶å·åœ°éœ‡30å°æ—¶æ·±åŸ‹åœ°ä¸‹çš„æ„Ÿæ‚Ÿ**)ï¼Œè€è™è¯åˆ¸ç‹çŠè€å¸ˆçš„**è¯»è´¢æŠ¥è¯¾**ï¼Œè¿˜æœ‰æç¬‘æ¥è€å¸ˆçš„**å†™ä½œè¯¾**å’Œ**å®šæŠ•è¯¾**ï¼Œ**å®šæŠ•æ—¶é—´**è¶…å€¼ä½“éªŒå¦‚æœä½ ä¹Ÿæƒ³åŠ å…¥ï¼Œä¸‹è½½å¹¶æ³¨å†Œ [**Mixin**](https://mixin.one/messenger) åŠ æˆ‘(ID: **21120**)å¥½å‹ï¼Œé€ä½ é‚€è¯·ç ã€‚

**æ³¨:** è·µè¡Œç¤¾åŒºæ˜¯å»ºç«‹åœ¨ [**Mixin Massager**](https://mixin.one/messenger) ä¸Šçš„ç¤¾ç¾¤ï¼Œæ‰€ä»¥ä½ å¿…é¡»å­¦ä¼šä½¿ç”¨ Mixin  Massager ï¼›åŒæ—¶è·µè¡Œç¤¾åŒºæ˜¯å°é—­è¯¾ç¨‹ç¤¾åŒºæ²¡æœ‰é‚€è¯·ç ä¸èƒ½åŠ å…¥ã€‚)
